{% load notifications_tags %}
{% load static %}
{% notifications_unread as unread_count %}
<li class="nav-item dropdown">
  <a class="nav-link" href="#" role="button" data-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
    <i class="ni ni-bell-55"></i>
    <span id="notif-count-badge" class="badge badge-danger badge-pill" {% if unread_count %}{% else %}style="display:none"{% endif %}>
      {% if unread_count >= 9 %}9+{% else %}{{ unread_count }}{% endif %}
    </span>
  </a>
  <div class="dropdown-menu dropdown-menu-xl dropdown-menu-right py-0 overflow-hidden">
    <div class="px-3 py-3">
      {% if unread_count %}
      <h6 class="text-sm text-muted m-0">
        Anda memiliki <strong class="text-primary">{{ unread_count }}</strong> notifikasi belum dibaca.
      </h6>
      {% else %}
      <h6 class="text-sm text-muted m-0">Tidak ada notifikasi baru.</h6>
      {% endif %}
    </div>

    <!-- Daftar notifikasi -->
    <div class="list-group list-group-flush">
      {% for notification in request.user.notifications.unread|slice:":5" %}
      <a href="{% url 'mark_as_read' notification.id %}" class="list-group-item list-group-item-action">
        <div class="row align-items-center">
          <div class="col-auto">
            <img alt="Image placeholder" src="{% static 'assets/img/theme/team-1.jpg' %}" class="avatar rounded-circle">
          </div>
          <div class="col ml--2">
            <div class="d-flex justify-content-between align-items-center">
              <h4 class="mb-0 text-sm">{{ notification.actor }}</h4>
              <small>{{ notification.timestamp|timesince }} yang lalu</small>
            </div>
            <p class="text-sm mb-0">{{ notification.verb }}</p>
          </div>
        </div>
      </a>
      {% endfor %}
      <a href="{% url 'all_notifications' %}" class="dropdown-item text-center text-primary font-weight-bold py-3">Lihat semua</a>
  </div>
</li>